var Pn="1.0.8";var xt=(e,t,n)=>(e.has(t)||e.set(t,n(t)),e.get(t)),it=(e,t,n)=>e<<16|t<<8|n,Bt=e=>it(e,e,e),z=e=>{if(e.length&&e.charAt(0)==="#"){if(e.length===4)return it(parseInt(e.charAt(1),16)*17,parseInt(e.charAt(2),16)*17,parseInt(e.charAt(3),16)*17);if(e.length===7)return it(parseInt(e.slice(1,3),16),parseInt(e.slice(3,5),16),parseInt(e.slice(5,7),16))}return 0},ur=(e,t)=>it(t*(e>>>16&255),t*(e>>>8&255),t*(e&255));var _t=0,fr=e=>_t=e,N={npc:{initWeaponLen:4,period:10,max:8},items:{lifetime:10*60},barrels:{initCount:32,hp:[3,7],dropWeapon:{chance:70,min:4}},trees:{initCount:64},camera:{size:256,listenerRadius:256,baseScale:1.1},player:{hp:10,sp:0,mags:1,jumpVel:80,runVel:120,walkVel:60},world:{gravity:5,gravityWeak:3},minimap:{size:48,markerScale:1,colors:{me:z("#fff"),player:z("#f00"),npc:z("#d06"),tree:z("#888"),barrel:z("#07f"),item:z("#0f0"),background:z("#010"),backgroundAlpha:.6}},bodyColor:[z("#FF99DD"),z("#FFCC99"),z("#CCFF99"),z("#222222"),z("#8855FF"),z("#CCCCCC")],voice:{killAB:["{0} CRUSHED {1}","{0} destroyed {1}","{0} killed {1}","{0} took {1} life"],killNPC:["warm-up for {0}","{0} killed someone","death by {0}","{0} sows DEATH"]}};var dr="l3";var wo=60,T={name:"",sound:1,music:1,speech:1,blood:1,particles:1,highDPI:1,frameRateCap:wo};for(let e of Object.keys(T)){let t=localStorage.getItem(dr+e);if(t!=null)switch(typeof T[e]){case"number":T[e]=parseFloat(t);break;case"string":T[e]=t;break}}function He(e,t){return T[e]=t,localStorage.setItem(dr+e,t),t}var J={enabled:!1,fps:1,collision:0,console:1,info:0};function Cn(e){return J.enabled&&J[e]}var be=new AudioContext,pr=(e,t,n,o)=>{if(!T.sound)return;let r=.5;o=be.createGain(),o.gain.value=t*r,o.connect(be.destination),t=be.createStereoPanner(),t.pan.value=n,t.connect(o),n=be.createBufferSource(),n.buffer=e,n.connect(t),n.start()},Gt=e=>{if(!T.speech||!("SpeechSynthesisUtterance"in window))return;let t=new SpeechSynthesisUtterance(e);t.volume=.5,speechSynthesis.speak(t)};var{max:Ze,min:ne,abs:en,sin:w,cos:V,atan2:Ce,hypot:de,PI:M,sqrt:xe,tan:xr,imul:_r,round:hr,exp:Ni,log:br}=Math,j=2*M,vn=M/180,ht=(e,t,n)=>(1-n)*e+n*t,Ar=(e,t,n)=>Ni(ht(br(e),br(t),n)),Mn=e=>e&&--e,Ae=(e,t,n)=>ne(n,Ze(e,t)),gr=e=>e>0?1:-1,ct=(e,t,n)=>e<t?ne(e+n,t):e>t?Ze(e-n,t):e;var Sr=`
attribute vec3 a_position;
attribute vec2 a_texCoord;
attribute vec4 a_colorMul;
attribute vec4 a_colorAdd;

uniform mat4 u_mvp;

varying vec2 v_texCoord;
varying vec4 v_colorMul;
varying vec3 v_colorAdd;

void main() {
    v_texCoord = a_texCoord;
    v_colorMul = vec4(a_colorMul.bgr * a_colorMul.a, (1.0 - a_colorAdd.a) * a_colorMul.a);
    v_colorAdd = a_colorAdd.bgr;
    gl_Position = u_mvp * vec4(a_position, 1.0);
}
`,Dr=`
precision mediump float;

uniform sampler2D u_tex0;

varying vec2 v_texCoord;
varying vec4 v_colorMul;
varying vec3 v_colorAdd;

void main() {
    vec4 color = v_colorMul * texture2D(u_tex0, v_texCoord);
    gl_FragColor = color + vec4(v_colorAdd * color.a, 0.0);
}
`,Er="a_position",Rr="a_texCoord",wr="a_colorMul",Fr="a_colorAdd",Tr="u_tex0",Pr="u_mvp";var Fo=0,Cr=0,ze={drawCalls:0,frameDrawCalls:0,fps:0},vr=e=>{ze.drawCalls=ze.frameDrawCalls,ze.frameDrawCalls=0,++Fo;let t=1;e-Cr>=t&&(ze.fps=Fo/t,Fo=0,Cr+=t)};var b=c.getContext("webgl",{antialias:!1});b.pixelStorei(37441,1);var Ot=()=>T.highDPI?devicePixelRatio:1,Po=()=>{let e=Ot(),t=document.body.clientWidth,n=document.body.clientHeight,o=t*e|0,r=n*e|0;(c.width!==o||c.height!==r)&&(c.width=o,c.height=r,c.style.width=t+"px",c.style.height=n+"px")};onresize=Po;setInterval(Po,1e3);Po();var Or=65535,In=3+2+2,Bn=In*4,P=new Float32Array(1<<18),pe=new Uint32Array(P.buffer),oe=new Uint16Array(1<<16),Mr=(e,t)=>(t=b.createShader(t),b.shaderSource(t,e),b.compileShader(t),t),Br=(e,t,n)=>{let o=b.createBuffer();return b.bindBuffer(e,o),b.bufferData(e,t,n),o},On=(e,t,n,o,r,s)=>{b.enableVertexAttribArray(e),b.vertexAttribPointer(e,t,r,s,n,o)},Ii=(e,t)=>{let n=Mr(e,35633),o=Mr(t,35632),r=b.createProgram();return b.attachShader(r,n),b.attachShader(r,o),b.linkProgram(r),b.deleteShader(n),b.deleteShader(o),r},We=0,on,At=Ii(Sr,Dr),rn={program:At,u_mvp:b.getUniformLocation(At,Pr),u_tex0:b.getUniformLocation(At,Tr),a_position:b.getAttribLocation(At,Er),a_texCoord:b.getAttribLocation(At,Rr),a_colorMul:b.getAttribLocation(At,wr),a_colorAdd:b.getAttribLocation(At,Fr)};function tn(e,t,n=35040){return{vb:Br(34962,e,n),ib:Br(34963,t,n)}}var ki=[[tn(P,oe)],[tn(P,oe)],[tn(P,oe)],[tn(P,oe)]],Nr=0,To=0,Ir=()=>{Nr=0,To=To+1&3};function Ui(e,t){b.bindBuffer(34962,t.vb),b.bindBuffer(34963,t.ib),On(e.a_position,3,Bn,0,5126,!1),On(e.a_texCoord,2,Bn,12,5126,!1),On(e.a_colorMul,4,Bn,20,5121,!0),On(e.a_colorAdd,4,Bn,24,5121,!0)}var sn=(e,t,n,o,r,s=.5,i=.5)=>({J:e.J,u:o,te:r,e:s,t:i,Ue:t/e.u,He:n/e.te,We:o/e.u,Le:r/e.te}),$e=e=>({J:b.createTexture(),u:e,te:e,e:0,t:0,Ue:0,He:0,We:1,Le:1}),kn=e=>{e.Ve=b.createFramebuffer(),b.bindFramebuffer(36160,e.Ve),b.bindTexture(3553,e.J),b.framebufferTexture2D(36160,36064,3553,e.J,0)},Je=(e,t,n=9728)=>{b.bindTexture(3553,e.J),b.texParameteri(3553,10240,n),b.texParameteri(3553,10241,n),t?b.texImage2D(3553,0,6408,6408,5121,t):b.texImage2D(3553,0,6408,e.u,e.te,0,6408,5121,null)},Un=(e,t,n,o,r,s,i,l)=>{let a=e-i*n,u=t-l*o,m=s*V(r),f=s*w(r),p=2/i,A=-2/l,F=1e5;b.uniformMatrix4fv(rn.u_mvp,!1,[m*p,f*A,0,0,-f*p,m*A,0,0,0,0,-1/F,0,(e*(1-m)+t*f)*p-2*a/i-1,(t*(1-m)-e*f)*A+2*u/l+1,0,1]),b.uniform1i(rn.u_tex0,0)},Hn=()=>{b.enable(3042),b.blendFunc(1,771),b.useProgram(rn.program)},kr=(e,t,n,o)=>{b.clearColor(e,t,n,o),b.clear(16384)},Ur=e=>{Hn();let t=e.u,n=e.te;Un(0,0,0,1,0,1,t,-n),b.bindFramebuffer(36160,e.Ve),b.viewport(0,0,t,n),b.scissor(0,0,t,n)};function Hr(e){b.uniformMatrix4fv(rn.u_mvp,!1,e)}var gt=(e,t,n,o,r,s,i=b.drawingBufferWidth,l=b.drawingBufferHeight)=>{Hn(),Un(e,t,n,o,r,s,i,l),b.bindFramebuffer(36160,null),b.viewport(0,0,i,l),b.enable(3089),b.scissor(0,0,i,l)};function Hi(){let e=ki[To],t=e[Nr++];return t||(t=tn(P,oe),e.push(t)),t}var ge=(e=We)=>{if(e){b.bindTexture(3553,on);let t=Hi();Ui(rn,t),b.bufferSubData(34962,0,P.subarray(0,e*In*4)),b.bufferSubData(34963,0,oe.subarray(0,e*6)),b.drawElements(4,6*e,5123,0);let n=b.getError();We=0,++ze.frameDrawCalls}},nn=0,re=e=>nn=e,H=(e,t,n,o=0,r=1,s=1,i=1,l=16777215,a=0,u=0)=>{(on!=e.J||We==Or)&&(ge(),on=e.J);let m=We*4,f=We*6,p=m*In;++We;let A=(i*255<<24|l)>>>0,F=(a*255<<24|u)>>>0,U=e.e,g=e.t,S=e.u*r,v=e.te*s,D=V(o),_=w(o),E=-U*S,B=E+S,Z=-g*v,Y=Z+v,X=e.Ue,te=e.He,O=X+e.We,q=te+e.Le;P[p++]=E*D-Z*_+t,P[p++]=E*_+Z*D+n,P[p++]=nn,P[p++]=X,P[p++]=te,pe[p++]=A,pe[p++]=F,P[p++]=B*D-Z*_+t,P[p++]=B*_+Z*D+n,P[p++]=nn,P[p++]=O,P[p++]=te,pe[p++]=A,pe[p++]=F,P[p++]=B*D-Y*_+t,P[p++]=B*_+Y*D+n,P[p++]=nn,P[p++]=O,P[p++]=q,pe[p++]=A,pe[p++]=F,P[p++]=E*D-Y*_+t,P[p++]=E*_+Y*D+n,P[p++]=nn,P[p++]=X,P[p++]=q,pe[p++]=A,pe[p++]=F,oe[f++]=m,oe[f++]=m+1,oe[f++]=m+2,oe[f++]=m+2,oe[f++]=m+3,oe[f++]=m};function Se(e,t,n,o,r=0,s=1,i=1,l=1,a=16777215,u=0,m=0){(on!=e.J||We==Or)&&(ge(),on=e.J);let f=We*4,p=We*6,A=f*In;++We;let F=(l*255<<24|a)>>>0,U=(u*255<<24|m)>>>0,g=e.e,S=e.t,v=e.u*s,D=e.te*i,_=V(r),E=w(r),B=-g*v,Z=B+v,Y=-S*D,X=Y+D,te=e.Ue,O=e.He,q=te+e.We,Pe=O+e.Le;P[A++]=B*_-Y*E+t,P[A++]=n,P[A++]=o-(B*E+Y*_),P[A++]=te,P[A++]=O,pe[A++]=F,pe[A++]=U,P[A++]=Z*_-Y*E+t,P[A++]=n,P[A++]=o-(Z*E+Y*_),P[A++]=q,P[A++]=O,pe[A++]=F,pe[A++]=U,P[A++]=Z*_-X*E+t,P[A++]=n,P[A++]=o-(Z*E+X*_),P[A++]=q,P[A++]=Pe,pe[A++]=F,pe[A++]=U,P[A++]=B*_-X*E+t,P[A++]=n,P[A++]=o-(B*E+X*_),P[A++]=te,P[A++]=Pe,pe[A++]=F,pe[A++]=U,oe[p++]=f,oe[p++]=f+1,oe[p++]=f+2,oe[p++]=f+2,oe[p++]=f+3,oe[p++]=f}var Wr=new Float32Array(1),Wi=new Uint32Array(Wr.buffer),Lr=e=>(Wi[0]=127<<23|e&(1<<23)-1,Wr[0]-1);var Li=e=>(e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,e>>>1),De=[,,,].fill(new Date>>>0),Wn=(e=0)=>Li(De[e]=_r(De[e],1103515245)+12345>>>0),L=e=>Wn()%e,Le=(e=1,t)=>e*Lr(Wn(t)),_e=(e=1)=>Le(e*2,1)-e,Nt=e=>Wn(1)%e,y=e=>Le(e,1),St=(e=1)=>Le(e,2),Ve=e=>2*St(e)-e,ae=e=>Wn(2)%e,Ln=e=>e[ae(e.length)];var Vr=(e,t)=>{try{e.H.send(t)}catch{}},Xr=e=>e.H.bufferedAmount;var Co=e=>`${e}px m,e`,It=[],C=[],an=(e,t)=>(t=document.createElement("canvas"),t.width=t.height=e,t=t.getContext("2d"),t.fillStyle=t.strokeStyle="#fff",t.textAlign="center",t.textBaseline="alphabetic",t),cn=(e,t)=>{e.beginPath(),e.arc(0,0,t-.3,0,j)},yr=()=>{let t=$e(512),n=an(512),o=an(512),r=1,s=1,i=1,l=0,a=0,u=0,m=(g,S)=>{r=i,i=r+g+1,i+1>=512&&(s+=1+l,l=S,r=1,i=r+g+1),S>l&&(l=S),a=g,u=S},f=(g,S)=>C.push(sn(t,r,s,a,u,g,S)),p=(g=128,S,v)=>{S=o.getImageData(r,s,a,u),v=S.data;for(let D=3;D<v.length;D+=4)v[D]=v[D]<g?0:255;o.putImageData(S,r,s)},A=(g,S,v,D,_,E=0,B=0,Z=1,Y=1,X,te,O)=>{let q=8,Pe=(16+E)*q;n.clearRect(0,0,512,512),n.font=Co(Pe),n.translate(512/2,512/2),n.rotate(B*vn),n.scale(Z,Y),n.fillText(g,0,Pe*.3),n.resetTransform(),m(D,_),o.translate(r+1,s+1),q=1/q,o.scale(q,q),o.translate(-S,-v),o.drawImage(n.canvas,0,0),o.resetTransform(),p(X),It[C.length]=g,f(te,O)},F=g=>{let S=g*2;m(S,S),o.translate(r+g,s+g),cn(o,g),o.fill(),o.resetTransform(),p(),f()};m(1,1),o.fillRect(r,s,1,1),f(),f(0,0),f(.5,0),f(.5,-1),f(0),f(1),F(4),f(.6),f(.7),F(16),f(),[["\u{1F52A}",180,234,19,7,-4,-50,,,,.3],["\u{1FA93}",198,210,20,10,,45,-1,,,.3],["\u{1F52B}",208,198,15,12,-4,,-1,,,.3],["\u{1F58A}\uFE0F",157,211,24,8,,-45,-1,,,,],["\u270F\uFE0F\uFE0F",186,216,23,8,,44.5,-1,,,,],["\u{1FAA5}",175,261,20,8,,45,,-1,,,],["\u26CF",196,216,21,17,,135,,,,,],["\u{1F50C}",188,202,22,11,,45,-1,,,,],["\u{1F9F5}",217,192,19,19,,90,,,,.3,.4],["\u{1F480}",198,166,17,19,,,,,,,],["\u{1F479}",192,166,19,18,,,,,,,],["\u{1F921}",192,166,19,19,,,,,,,],["\u{1F916}",192,166,19,18,,,,,,,],["\u{1F383}",192,166,19,19,,,,,,,],["\u{1F99D}",192,172,19,17,,,,,,,],["\u{1F419}",192,166,19,18,,,,,,,],["\u{1F430}",186,144,20,23,4,,,,,,.65],["\u{1F98C}",176,144,23,23,4,,,,,,.67],["\u{1F43A}",181,153,21,20,4,,,,,,],["\u{1F435}",181,144,21,23,4,,,,,,],["\u{1F98A}",177,153,22,20,4,,,,,,],["\u{1F42D}",176,148,23,22,4,,,,,,],["\u{1F98D}",179,145,22,22,4,,,,,,],["\u{1F345}",195,166,18,19,,,,,,,],["\u{1F610}",192,166,19,19,,,,,,,],["\u{1F437}",192,170,19,17,,,,,,,],["\u{1F9D1}\u200D\u{1F384}",192,166,19,18,,,,,,,],["\u{1F385}\u{1F3FB}",192,166,19,19,,,,,,,],["\u{1F385}\u{1F3FC}",192,166,19,19,,,,,,,],["\u{1F385}\u{1F3FE}",192,166,19,19,,,,,,,],["\u{1F385}",192,166,19,19,,,,,,,],["\u{1F6E2}",203,144,16,23,4,,,,,,.95],["\u{1F4E6}",193,144,18,22,4,,,,,,.85],["\u{1FAA6}",176,144,23,23,4,,,,,,.95],["\u2764\uFE0F",208,194,15,13,-4,,,,,,],["\u{1F48A}",216,200,13,13,-6,,,,,,],["\u{1FA99}",211,189,14,15,-4,,,,,,],["\u{1F48E}",208,197,15,13,-4,,,,,,],["\u{1F6E1}",213,189,13,15,-4,,,,,,],["\u{1F9F1}",209,200,14,12,-4,,,,,,],["\u{1F333}",156,99,28,31,12,,,,136,,.95],["\u{1F332}",162,99,26,31,12,,,,136,,.95],["\u{1F335}",150,99,29,30,12,,,,136,,.95],["\u{1F334}",159,100,27,30,12,,,,136,,.95],["\u{1F384}",174,100,24,30,12,,,,136,,.95],["\u26C4",156,99,28,31,12,,,,136,,.95],["\u{1F953}",163,219,22,9,,-45,,,,,],["\u{1F9B4}",163,213,21,9,,-45,,,,,]].map(g=>A(...g)),m(4,2),o.fillRect(r,s,4,2),o.fillStyle="#999",o.fillRect(r,s,1,2),f(),o.fillStyle="#fff";let U=(g,S,v,D)=>{let _=S*2+32;m(_,_),o.font=Co(10),o.lineWidth=2,_/=2,o.translate(r+_,s+_),cn(o,g),o.stroke(),cn(o,S),o.stroke(),o.fillText(v,0,-g-3),o.fillText(D,0,-S-3),o.resetTransform(),p(),f()};U(16,48,"RUN","JUMP"),U(16,40,"AIM","FIRE"),U(16,16,"DROP",""),U(16,16,"RELOAD",""),U(16,16,"SWAP",""),m(72,64),o.font=Co(72),o.fillText("13",r+72/2,s+51),p(),f(),Je(t,o.canvas);{let g=an(64);g.translate(32,32);let S=g.createRadialGradient(0,0,32/2,0,0,32);S.addColorStop(0,"rgba(255,255,255,1)"),S.addColorStop(1,"rgba(255,255,255,0)"),g.fillStyle=S,cn(g,32),g.fill(),g.scale(1,.25),cn(g,32),g.fill(),g.resetTransform(),C[66]=$e(64),C[66].e=.5,C[66].t=.5,Je(C[66],g.canvas,9729)}};var Yr=[{primaryColor:"#060",splatColors:["#080","#572"],splatR:[1,16],rectW:[1,1],rectH:[4,12],treeGfx:[0,1]},{primaryColor:"#753",splatColors:["#876","#863"],splatR:[1,16],rectW:[1,4],rectH:[1,4],treeGfx:[2,3]},{primaryColor:"#acd",splatColors:["#ade","#aef"],splatR:[1,16],rectW:[1,12],rectH:[1,2],treeGfx:[4,5]}],kt=$e(1024);kn(kt);var qr=(e=0,t=1024,n=an(t))=>{let o=L(Yr.length),r=Yr[o];n.fillStyle=r.primaryColor,n.fillRect(0,0,t,t);let s=4;for(n.scale(1,1/s);e++<t;){n.fillStyle=r.splatColors[L(r.splatColors.length)],n.beginPath();let i=r.splatR[0]+L(r.splatR[1]-r.splatR[0]);n.arc(L(t),L(t)*s,i,0,j),n.fill();let l=r.rectW[0]+L(r.rectW[1]-r.rectW[0]),a=r.rectH[0]+L(r.rectH[1]-r.rectH[0]);n.fillRect(L(t),L(t)*s,l,a)}return Je(kt,n.canvas),r};var ln=()=>({ne:0,l:0,X:0,ie:0,i:[[],[],[],[]],Y:new Map}),Ut=(e,t)=>j*(e&t-1)/t-M,No=(e,t)=>t*e&t-1,ve=(e,t,n)=>No((M+Ce(t,e))/j,n);var Vi=(e,t,n)=>{e.ne=t[n++],e.l=t[n++],e.X=t[n++]>>>0,e.ie=t[n++]>>>0;let o=t[n++];for(let s=0;s<o;++s){let i=t[n++],l=t[n++],a=t[n++],u=t[n++],m=t[n++],f={F:i&7,o:i>>3&15,C:i>>7&255,k:i>>15&255,m:i>>23&15,N:l>>16&15,oe:a>>16&31,L:u>>16&31,e:l&65535,t:a&65535,s:u&65535,f:l>>21,d:a>>21,u:u>>21,M:t[n++],c:t[n++],n:t[n++],P:m&63,p:m>>6&63,_:m>>12&15,Se:m>>16&63,B:m>>22&15,v:m>>26&15};e.i[f.F].push(f)}let r=t[n++];for(let s=0;s<r;++s)e.Y.set(t[n++],{be:t[n++],xe:t[n++]});return n},jr=(e,t,n=[],o,r)=>{let s=t[2],i=3;for(;s;){let l=t[i++],a=l>>21;if(n.push({l:s,c:e,n:l&2097151}),s+=a,!a)break}return t[1]&2&&(o=ln(),i=Vi(o,t,i)),{Xe:t[1]&1,l:t[0],Ce:t[0]+(t[1]>>16),ye:n,K:o,debug:r}},Xi=(e,t,n)=>{if(e){t[n++]=e.ne,t[n++]=e.l,t[n++]=e.X,t[n++]=e.ie;let o=[].concat(...e.i);t[n++]=o.length;for(let r of o)t[n++]=r.F|r.o<<3|r.C<<7|r.k<<15|r.m<<23,t[n++]=r.f<<21|r.N<<16|r.e,t[n++]=r.d<<21|r.oe<<16|r.t,t[n++]=r.u<<21|r.L<<16|r.s,t[n++]=r.P|r.p<<6|r._<<12|r.Se<<16|r.B<<22|r.v<<26,t[n++]=r.M,t[n++]=r.c,t[n++]=r.n;t[n++]=e.Y.size;for(let[r,s]of e.Y)t[n++]=r,t[n++]=s.be,t[n++]=s.xe}return n},Zr=(e,t)=>{t[0]=e.l,t[1]=e.Ce-e.l<<16|e.Xe|!!e.K<<1;let n=e.ye;n.sort((i,l)=>i.l-l.l);let o=n.length?n[0].l:0;t[2]=o;let r=3,s=0;for(;s<n.length;){let i=n[s++],l=n[s]?n[s].l-i.l:0;t[r++]=l<<21|i.n}return r=Xi(e.K,t,r),t.buffer.slice(0,r*4)};var Me,at=new Map,se=[],Be=[],$r=[];{let e=a=>xt(at,a,n),t=()=>{be.state[0]=="s"&&be.resume().catch()},n=a=>({M:a,De:0,Ee:0,e:0,t:0,ve:!1,Re:!1,q:!1}),o=(a,u,m)=>{a.e=u,a.t=m,a.De=u,a.Ee=m,a.ve=!0,a.q=!0},r=(a,u,m)=>{a.e=u,a.t=m},s=a=>{a.Re=a.q,a.q=!1},i=(a,u,m=c.getBoundingClientRect())=>{u(Me,(a.clientX-m.x)*Ot()|0,(a.clientY-m.y)*Ot()|0)},l=(a,u,m=c.getBoundingClientRect(),f)=>{a.preventDefault();for(f of a.changedTouches)u(e(f.identifier),(f.clientX-m.x)*Ot()|0,(f.clientY-m.y)*Ot()|0)};Me=n(0),oncontextmenu=a=>a.preventDefault(),onkeydown=(a,u=a.which)=>{t(),!se[u]&&!a.repeat&&(Be[u]=se[u]=1)},onkeyup=(a,u=a.which)=>{a.preventDefault(),$r[u]=se[u],se[u]=0},c.onmousedown=a=>{i(a,o)},c.onmouseup=a=>{t(),s(Me)},c.onmouseleave=a=>{s(Me)},c.onmouseenter=a=>{a.buttons&&i(a,o)},c.onmousemove=a=>{i(a,r)},c.ontouchstart=a=>{l(a,o)},c.ontouchmove=a=>{l(a,r)},c.ontouchend=(a,u)=>{t(),a.preventDefault();for(u of a.changedTouches)s(e(u.identifier))}}var zr=e=>e.ve=e.Re=!1,Jr=()=>{Be.length=0,$r.length=0,zr(Me),at.forEach(zr)},Vn=()=>Be.length||Me.Re||[...at.values()].some(e=>e.Re);var Q=0,Qr=()=>{Q=0},Xn=e=>{e>Q&&(Q=e)},Xe=()=>ne(b.drawingBufferWidth,b.drawingBufferHeight)/N.camera.size,yn=e=>e===W?Ee:he.get(e)?.I;var mn=[{length:.2,lightLength:.1,size:6,pulse:0,color:[16777215],images:[7,8,0]},{length:2,lightLength:2,size:3/2,pulse:0,color:[16777028],images:[7,8,0]},{length:1,lightLength:2,size:2,pulse:1,color:[4521983],images:[7,8,0]},{length:8,lightLength:2,size:4,pulse:0,color:[3355443],images:[5,5,5]},{length:512,lightLength:512,size:12,pulse:0,color:[16711680,65280,65535,16776960,16711935],images:[4,4,4]}];var Kr=()=>({I:"",j:60,re:0,et:2,tt:1,nt:0,ce:0,we:0,Me:0,G:0,ot:0,rt:0,Z:1,z:0,se:0,Ye:1,qe:0,dt:1,ae:0,le:0,$:1,je:0,Be:1,T:0,p:0,st:0,Ze:4294967295,moveWeightK:1}),Io=()=>{let e=Kr();return e.ce=.5,e.re=30,e.we=10,e.Me=6,e.G=300,e.Z=16,e.z=.02/5,e.se=.1,e.ae=12,e.$=2,e.je=3,e.Ze=32*60,e},Et=()=>{let e=Kr();return e.we=32,e.Me=16,e.G=600,e.Z=16,e.z=.02/5,e.se=.2,e.le=1,e.Fe=16768290,e.T=30,e.p=60,e.st=24*60,e.Ze=256*60,e.moveWeightK=.8,e},d=[Io(),Io(),Io(),Et(),Et(),Et(),Et(),Et(),Et(),Et()],x=1;d[x].I="Knife";d[x].j=10;d[x].re=5;d[x].$=2;d[x].qe=-45;++x;d[x].I="Axe";d[x].j=30;d[x].re=15;d[x].$=8;d[x].qe=-45;d[x].moveWeightK=.9;++x;d[x].I="Pistol";d[x].$=3;d[x].ce=.1;d[x].G/=2;d[x].et=16;d[x].Z=16;d[x].z=.02;d[x].T=9*3;d[x].moveWeightK=1;++x;d[x].I="Automatic Gun";d[x].j=5;d[x].ce=.25;d[x].we=20;d[x].Me=20;d[x].Z=16;d[x].z=.02;++x;d[x].I="Machine Gun";d[x].j=8;d[x].ce=.25;d[x].we=20;d[x].G/=2;d[x].Z=16;d[x].z=.05;d[x].se=.3;d[x].$=2;++x;d[x].I="Shotgun";d[x].tt=5;d[x].ce=.5;d[x].Z=32;d[x].z=.1;d[x].G=300;d[x].ot=200;d[x].ae=1;d[x].nt=.5;d[x].Be=2;d[x].$=2;d[x].Fe=11141120;d[x].T=7;d[x].moveWeightK=.9;++x;d[x].I="Crossbow";d[x].Z=1;d[x].z=.2;d[x].se=.4;d[x].Ye=1.5;d[x].G=960;d[x].ae=1;d[x].$=5;d[x].le=3;d[x].Fe=65280;d[x].T=7;d[x].moveWeightK=.9;++x;d[x].I="Plasma Gun";d[x].ce=.5;d[x].Z=10;d[x].j=10;d[x].se=.3;d[x].z=.05;d[x].G=420;d[x].$=1;d[x].Be=2;d[x].le=2;d[x].Fe=65535;d[x].T=35;++x;d[x].I="Railgun";d[x].j=120;d[x].rt=25;d[x].G=1e3;d[x].z=.1;d[x].se=.4;d[x].Ye=1.4;d[x].$=5;d[x].Be=15;d[x].le=4;d[x].je=10;d[x].Fe=10027161;d[x].T=5;var I=[0,0,1],Qe=0,Ke=0,Re=0,we=0,qn=!1,jn=!1,Ht=0,Wt=0,Zn=!1,zn=!1,$n=!1,Jn=!1,ko=e=>{let t=d[e.o];return t&&!e.p&&t.T&&e.P<t.T},Yi=e=>!!e.B,ts=e=>{let t=b.drawingBufferWidth,n=b.drawingBufferHeight,o=Me,r=e.e/60,s=(e.t-e.s)/60-10;if(o.e>=0&&o.e<t&&o.t>=0&&o.t<n?(Qe=(o.e-t/2)*I[2]+I[0],Ke=(o.t-n/2)*I[2]+I[1],Re=Qe-r,we=Ke-s):(Re=0,we=0),qn=(Re||we)&&o.q,Ht=(se[68]|se[39])-(se[65]|se[37]),Wt=(se[83]|se[40])-(se[87]|se[38]),Zn=!se[16],jn=!!se[32],zn=!!se[69],$n=!!se[82],Jn=!!se[81],ye[3].it=!ko(e),ye[4].it=!Yi(e),ji()){let i=I[2],l=ye[0],a=l.V;Ht=a?(a.e-a.De)*i:0,Wt=a?(a.t-a.Ee)*i:0;let u=de(Ht,Wt);Zn=u>l.ct,jn=u>l.ze,l=ye[1],a=l.V,Re=a?(a.e-a.De)*i:0,we=a?(a.t-a.Ee)*i:0,u=de(Re,we),Qe=r+Re*2,Ke=s+we*2,qn=u>l.ze,zn=!!ye[2].V,$n=!!ye[3].V,Jn=!!ye[4].V}},ye=[{ue:0,fe:.5,U:.5,_e:1,ct:16,ze:48},{ue:.5,fe:.5,U:1,_e:1,ct:16,ze:40},{ue:.5,fe:.25,U:.66,_e:.5,Oe:1},{ue:.66,fe:.25,U:.82,_e:.5,Oe:1},{ue:.82,fe:.25,U:1,_e:.5,Oe:1}],Yn=!1,qi=e=>!ye.some(t=>t.V==e),Gr=(e,t,n)=>t>e.ue&&t<e.U&&n>e.fe&&n<e._e,ji=()=>{let e=b.drawingBufferWidth,t=b.drawingBufferHeight;for(let n of ye){if(!n.V)for(let[,o]of at)o.ve&&Gr(n,o.De/e,o.Ee/t)&&qi(o)&&(n.V=o);if(n.V){let o=n.V,r=!o.q;n.Oe&&(r||(r=!Gr(n,o.e/e,o.t/t))),r?n.V=void 0:Yn=!0}}return Me.ve&&(Yn=[...at.values()].some(n=>n.q)),Yn},ns=()=>{if(!Yn)return;let e=b.drawingBufferWidth,t=b.drawingBufferHeight,n=1/Xe(),o=60;for(let r of ye){if(!r.it){let s=e*(r.U-r.ue),i=t*(r._e-r.fe),l=n*(e*r.ue+s/2),a=n*(t*r.fe+i/2),u=r.V;!r.Oe&&u&&(l=u.De*n,a=u.Ee*n,H(C[9],u.e*n,u.t*n,0,1,1,.5)),H(C[o],l,a,0,1,1,.5,u?16777215:0)}++o}};var Fe=e=>Zi(...e),Zi=(e=1,t=.05,n=220,o=0,r=0,s=.1,i=0,l=1,a=0,u=0,m=0,f=0,p=0,A=0,F=0,U=0,g=0,S=1,v=0,D=0,_=44100,E=.3)=>{let B=a*=500*j/_/_,Z=n*=(1+t*2*St()-t)*j/_,Y=[],X=0,te=0,O=0,q=1,Pe=0,Eo=0,Ue=0,Kt,rt;for(o=o*_+9,v*=_,r*=_,s*=_,g*=_,u*=500*j/_**3,F*=j/_,m*=j/_,f*=_,p=p*_|0,rt=o+v+r+s+g|0;O<rt;Y[O++]=Ue)++Eo%(U*100|0)||(Ue=i?i>1?i>2?i>3?w((X%j)**3):Ae(xr(X),-1,1):1-(2*X/j%2+2)%2:1-4*en(hr(X/j)-X/j):w(X),Ue=(p?1-D+D*w(j*O/p):1)*gr(Ue)*en(Ue)**l*e*E*(O<o?O/o:O<o+v?1-(O-o)/v*(1-S):O<o+v+r?S:O<rt-g?(rt-O-g)/s*S:0),Ue=g?Ue/2+(g>O?0:(O<rt-g?1:(rt-O)/g)*Y[O-g|0]/2):Ue),Kt=(n+=a+=u)*V(F*te++),X+=Kt-Kt*A*(1-(w(O)+1)*1e9%2),q&&++q>f&&(n+=m,Z+=m,q=0),p&&!(++Pe%p)&&(n=Z,a=B,q=q||1);let st=be.createBuffer(1,Y.length,_);return st.getChannelData(0).set(Y),st};var Qn=[Fe([,,103,,.02,.06,,1.24,-18,4.4,,,,.7,,.1,,.95,.03]),Fe([1.27,,390,.01,.04,.02,4,.71,4.8,,,,,,,,.01,.6,.06]),Fe([1.12,,73,,.02,.11,2,1.18,,-.1,,,,,,.3,,.55,.05,.23]),Fe([1.99,,770,.03,.19,.35,,.26,,,,,,2,-50,.1,.27,.48,.06]),Fe([.5,0,1500,.02,,.02,4,.68,5,,,,.01,.7,136,,,,,.11]),Fe([,0,288,.05,.01,,,2,-10,,,,,,,,,.5,.1]),Fe([,0,700,.01,,0,,,,,,,,,,,,.1,.01]),Fe([2.21,,107,.02,.04,.07,,2.22,2,.9,,,,.4,,.5,.15,.42,.04]),Fe([.5,0,43,.01,,1,2,,,,,,,,,.02,.01]),Fe([.5,0,86,,,,,.7,,,,.5,,6.7,1,.05]),Fe([.5*.4,0,270,,,.12,3,1.65,-2,,,,,4.5,,.02]),Fe([.3*.8,0,2200,,,.04,3,2,,,800,.02,,4.8,,.01,.1])];var me=10*60,Lt=6*60,un=10,Uo=un*60,os=31,fn=15,$=[{radius:me,height:me+4*60,groundLoss:512,boundsLoss:2,groundFriction:0,imass:1,shadowScale:1,shadowAdd:0,shadowColor:0},{radius:me,height:me,groundLoss:2,boundsLoss:2,groundFriction:8,imass:1,shadowScale:1,shadowAdd:0,shadowColor:0},{radius:Lt,height:0,groundLoss:512,boundsLoss:1,groundFriction:0,imass:1,shadowScale:2,shadowAdd:1,shadowColor:3355443},{radius:me+4*60,height:Lt,groundLoss:2,boundsLoss:2,groundFriction:8,imass:1,shadowScale:1,shadowAdd:0,shadowColor:0},{radius:me+4*60,height:me+4*60,groundLoss:512,boundsLoss:0,groundFriction:8,imass:0,shadowScale:1,shadowAdd:0,shadowColor:0}];var dn=e=>{e.e=me+L(61440-me*2),e.t=me+L(61440-me*2)},Ge=(e,t)=>{e.e=t.e,e.t=t.t,e.s=t.s+$[t.F].height},pn=(e,t,n)=>{if(Xt(e,e.f,e.d,e.u),e.s>0)e.u-=t;else if(e.s=0,e.u<0)return e.u=-e.u/n,!0;return!1},Ho=e=>{e.L=ct(e.L,0,2)},Kn=e=>{let t=$[e.F],n=N.world,o=e.F?0:e.n&4;pn(e,o?n.gravityWeak:n.gravity,t.groundLoss),Wo(e),e.s<=0&&Vo(e,t.groundFriction),Ho(e)},Wo=e=>{let t=$[e.F];return Lo(e,t.radius,t.boundsLoss)},Lo=(e,t,n)=>{let o=0;return e.t>61440-t?(e.t=61440-t,o|=2,Vt(e,0,1,n)):e.t<t&&(e.t=t,o|=2,Vt(e,0,1,n)),e.e>61440-t?(e.e=61440-t,o|=4,Vt(e,1,0,n)):e.e<t&&(e.e=t,o|=4,Vt(e,1,0,n)),o},mt=(e,t,n,o)=>{yt(e,n*V(t),n*w(t)/2,o)},Vt=(e,t,n,o)=>{let r=2*(e.f*t+e.d*n);e.f=(e.f-r*t)/o,e.d=(e.d-r*n)/o},ss=(e,t)=>{let n=e.f*e.f+e.d*e.d;n>t*t&&(n=t/xe(n),e.f*=n,e.d*=n)},Vo=(e,t)=>{let n=e.f*e.f+e.d*e.d;n>0&&(n=xe(n),n=ct(n,0,t)/n,e.f*=n,e.d*=n)},et=(e,t,n=1)=>yt(e,t.f,t.d,t.u,n),yt=(e,t,n,o,r=1)=>{e.f+=r*t,e.d+=r*n,e.u+=r*o},Xt=(e,t,n,o,r=1)=>{e.e+=r*t,e.t+=r*n,e.s+=r*o},Xo=(e,t,n)=>e*e+t*t+n*n,is=(e,t)=>{let n=e.e-t.e,o=e.t-t.t;return n*n+o*o},yo=(e,t)=>{let n=$[e.F],o=$[t.F],r=n.radius+o.radius;return Xo(e.e-t.e,e.t-t.t,e.s+n.height-t.s-o.height)<r*r},Yt=(e,t)=>{let n=$[e.F],o=$[t.F],r=e.e-t.e,s=(e.t-t.t)*2,i=e.s+n.height-(t.s+o.height),l=Xo(r,s,i),a=n.radius+o.radius;if(l>0&&l<a*a){let u=(a/xe(l)-1)/2;Xt(e,r,s,i,n.imass*u),Xt(t,r,s,i,-o.imass*u)}},Gn=(e,t,n,o)=>{let r=t.e-e.e,s=t.t-e.t,i=r*n+s*o,l=$[t.F],a=l.radius;return i>=0&&Xo(r-n*i,s-o*i,t.s+l.height-e.s)<=a*a},Yo=e=>{for(let t of e)t.e=t.e&65535,t.t=t.t&65535,t.s=Ae(t.s|0,0,1<<14),t.f=Ae(t.f|0,-1024,1024),t.d=Ae(t.d|0,-1024,1024),t.u=Ae(t.u|0,-1024,1024)};var cs=e=>{let t=1-e;return 1-t*t*t};var zi=/\s/gm,$i=" ".codePointAt(0),Ji="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890.,'-/",Qi={supported:0,left:0,right:0,ascent:0,descent:0},Ki=(e,t,n,o)=>{let r=document.createElement("canvas"),s=128;r.width=r.height=s;let i=r.getContext("2d",{willReadFrequently:!0}),a={fallback:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif',style:o,size:t,scale:n,family:e,ctx:i,texture:$e(s),nextSheetX:0,nextSheetY:0,sheetLineHeight:0,characters:"",border:Math.ceil(n),characterMap:new Map,lineSize:1.3,dirty:!0,strokeWidth:o.strokeWidth??0,strokeColor:o.strokeColor?`rgba(${o.strokeColor.r},${o.strokeColor.g},${o.strokeColor.b},${o.strokeColor.a})`:"rgba(0,0,0,0.5)"};return as(a),a},Gi=e=>{let t=e.ctx.canvas,n=t.width<<1;e.texture.u=e.texture.te=t.width=t.height=n,as(e,e.characters)},ec=e=>{let t=Math.ceil(e.size*e.scale);e.ctx.font=`${t}px ${e.family},${e.fallback}`,e.ctx.fillStyle="rgb(255,255,255)",e.ctx.textBaseline="alphabetic",e.ctx.textAlign="left"},as=(e,t=Ji)=>{e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height),ec(e),e.nextSheetX=0,e.nextSheetY=0,e.characterMap.clear(),tc(e),e.characters="",nc(e,t),ls(e)},tc=e=>{let t=e.ctx.measureText(" ").width/e.scale;e.characterMap.set($i,{a:t,x:0,y:0,w:t,h:e.size*e.lineSize,tex:sn(e.texture,0,0,0,0,0,0)})},nc=(e,t)=>{let n=t.replace(zi,"");for(let o=0;o<n.length;o++)eo(e,n.codePointAt(o))},oc=(e,t)=>{let n=Qi;if(n.supported===0&&(n.supported="actualBoundingBoxLeft"in t&&"actualBoundingBoxRight"in t&&"actualBoundingBoxAscent"in t&&"actualBoundingBoxDescent"in t?2:1),n.supported===2)n.left=t.actualBoundingBoxLeft,n.right=t.actualBoundingBoxRight,n.ascent=t.actualBoundingBoxAscent,n.descent=t.actualBoundingBoxDescent;else{let o=e.size*e.scale;n.left=0,n.right=t.width,n.ascent=Math.ceil(.7*o),n.descent=Math.ceil(.3*o)}return n},eo=(e,t)=>{if(e.characterMap.has(t))return e.characterMap.get(t);let n=String.fromCodePoint(t),o=e.ctx,r=o.canvas,s=1/e.scale,i=o.measureText(n),l=oc(e,i),a=e.border+e.strokeWidth*e.scale,u=l.right+l.left+2*a,m=l.descent+l.ascent+2*a,f=e.nextSheetX,p=e.nextSheetY;if(f+u>r.width&&(f=0,p+=e.sheetLineHeight,e.sheetLineHeight=0,p+m>r.height))return Gi(e),eo(e,t);m>e.sheetLineHeight&&(e.sheetLineHeight=m);let A={a:i.width*s,x:-(l.left+a)*s,y:-(l.ascent+a)*s,w:u*s,h:m*s,tex:sn(e.texture,f,p,u,m,0,0)};e.characterMap.set(t,A),e.characters+=n;let F=f+l.left+a,U=p+l.ascent+a;e.strokeWidth>0&&(o.strokeStyle="rgba(0,0,0,0.5)",o.lineWidth=2*e.strokeWidth*e.scale,o.lineJoin="round",o.strokeText(n,F,U),o.strokeText(n,F,U+1)),o.fillStyle="#fff",o.fillText(n,F,U);{let g=o.getImageData(f,p,u,m),S=g.data;for(let v=3;v<S.length;v+=4)S[v]=S[v]<128?0:255;o.putImageData(g,f,p)}return f+=u,e.nextSheetX=f,e.nextSheetY=p,e.dirty=!0,A},ls=e=>{e.dirty&&(Je(e.texture,e.ctx.canvas),e.dirty=!1)},K=[],ms=()=>{K[0]=Ki("m,e",24,1,{strokeWidth:3})},us=()=>K.forEach(ls);var fs=`
`.codePointAt(0),bn=(e,t,n,o,r,s,i,l=16777215)=>{let a=n/e.size,u=o,m=o,f=r;for(let p of t){let A=p.codePointAt(0);if(A===fs){m=u,f+=s+i;continue}let F=eo(e,A);F.tex&&H(F.tex,m+a*F.x,f+a*F.y,0,a,a,1,l),m+=a*F.a}},rc=(e,t,n)=>{let o=n/e.size,r=0,s=0;for(let i of t){let l=i.codePointAt(0);if(l===fs){r=0;continue}let a=eo(e,l);r+=o*a.a,r>s&&(s=r)}return s},sc=(e,t,n,o,r,s=16777215)=>{bn(e,t,n,o,r,0,0,s)},fe=(e,t,n,o,r,s=16777215)=>{o-=rc(e,t,n)/2,sc(e,t,n,o,r,s)};var xn=()=>({e:0,t:0,s:0,f:0,d:0,u:0,he:0,U:0,at:1,de:16777215,ee:1,$e:0,Ne:0,Te:600,Ae:57,ge:0,Je:0,Qe:1,Ke:1,Pe:0,lt:0,mt:0}),ic=e=>{if(e.he+=e.U,++e.Ne,pn(e,e.at*N.world.gravity,2)){if(e.Pe){let t=de(e.f,e.d,e.u);if(t<4||e.lt){let n=1+e.mt*t,o=e.he;e.ge>0&&(o+=e.ge*Ce(e.d,e.f)),Rt.push(e.Pe,e.e/60,e.t/60,o,e.Qe*n,e.Ke*xe(n),e.de)}if(t<4)return!0}e.f/=2,e.d/=2,e.U=-e.U/2}return Lo(e,4,2),e.Ne>e.Te},ds=(e,t=0)=>{for(;t<e.length;)ic(e[t++])&&e.splice(--t,1)};function bs(){ds(Ye),ds(wt),uc(qt)}var xs,_s,wt=[],hs,Ye=[],qt=[],As=[],Rt=[],gs=()=>{xs=De[1],_s=wt.map(e=>({...e})),hs=Ye.map(e=>({...e})),As=qt.map(e=>({...e}))},Ss=()=>{wt.length=0,Ye.length=0,qt.length=0,Rt.length=0},Ds=()=>{De[1]=xs,wt=_s,Ye=hs,qt=As,Rt.length=0},qo=(e=Rt,t=0)=>{for(re(.1);t<e.length;)H(C[e[t++]],e[t++],e[t++],e[t++],e[t++],e[t++],1,e[t++])},Es=()=>{for(let e of Ye)Fs(e)},ps=e=>{for(let t of e)if(t.s/60>1){let n=.5-t.s/60/256,o=1-t.Ne/t.Te;H(C[6],t.e/60,t.t/60,0,n,n/4,.4*o,0)}},Rs=()=>{re(.1),ps(wt),ps(Ye)},ws=()=>{for(let e of wt)Fs(e)},Fs=e=>{let t=Ze(0,1-e.ge+e.Je*de(e.f,e.d,e.u)),n=e.ge*Ce(e.d-e.u,e.f),o=e.Ne/e.Te,r=e.ee+e.$e*(o*o*o),s=n+e.he;re(e.s/60+.1),H(C[e.Ae],e.e/60,e.t/60,s,r*t,r,1,e.de)},cc=[z("#2fff00"),z("#00fff7"),z("#007eff"),z("#8300ff"),z("#ff00ff"),z("#ff4b00"),z("#fffd00")],ac=[z("#FF0000")],to=(e,t,n,o)=>{if(!T.blood)return;let r=T.blood===1?ac:cc,s=t.M??Nt(r.length),i=r[s%r.length];for(e=e*T.particles|0;e--;){let l=xn();Ge(l,t),o&&et(l,o,y(.5));let a=n*xe(y());mt(l,_e(M),a,a*V(y(M))),l.d/=2,l.de=ur(i,.5+y(.2)),l.Ae=59,l.Pe=6,l.lt=1,l.Qe=.5,l.Ke=.5/2,l.mt=(1+xe(y()))/100,l.ee=(1+y())/2,l.ge=1,l.Je=.02,Ye.push(l)}},Ts=(e,t,n)=>{for(e=e*T.particles|0;e--;){let o=xn();Ge(o,t),n&&et(o,n,y(.5)),mt(o,_e(M),64-128*xe(y()),y(128));let r=y()<.3?57:58;o.Ae=r,o.Pe=r,o.ee=.5+y(.25),o.Qe=o.ee,o.Ke=o.ee,o.de=Bt(200+y(50)),o.U=_e(.1),o.he=_e(.5),wt.push(o)}},Ps=(e,t,n)=>{let o=xn();o.e=e.e,o.t=e.t,o.s=e.s+t,o.Ae=59,o.Pe=59,o.de=n,o.U=_e(.25),o.he=_e(M),mt(o,_e(M),16+y(32),32),Ye.push(o)};function Cs(e,t){Rt.push(0,(e.e+t)/60+_e(1),e.t/60+_e(1),0,1+y(),1,Bt(68+y(16)))}function no(e,t,n){for(;n--;){let o=xn(),r=t*xe(y()),s=_e(M);o.e=e.e+r*V(s),o.t=e.t+r*w(s),o.s=10,o.Ae=0,o.de=Bt(102+y(34)),o.U=_e(.25),o.he=_e(M),o.Te=10+Nt(40),o.at=-y(.1),o.ee=8*(.4+y(.5)),o.$e=-o.ee,mt(o,_e(M),16+y(16),8),Ye.push(o)}}var vs=()=>{Rt.length&&(b.bindFramebuffer(36160,kt.Ve),Hn(),Un(0,0,0,1,0,1,1024,-1024),b.viewport(0,0,1024,1024),b.scissor(0,0,1024,1024),b.disable(2929),b.depthMask(!1),qo(),Rt.length=0,ge())},oo=(e,t,n,o)=>{for(e=e*T.particles|0;e--;){let r=xn();Ge(r,t),et(r,n,-y(.2)),mt(r,_e(M),32*xe(y()),0),r.de=o[Nt(o.length)],r.Ae=4,r.ee=1+y(1),r.$e=-r.ee,r.ge=1,r.Je=.02,r.Te=16+y(16),Ye.push(r)}},lc=(e,t)=>({e:e.e,t:e.t,s:e.s,pt:t,ut:3*60,Ge:0}),mc=e=>(++e.Ge,e.Ge/e.ut>=1),uc=(e,t=0)=>{for(;t<e.length;)mc(e[t++])&&e.splice(--t,1)},ut=(e,t)=>{qt.push(lc(e,t))},Ms=()=>{for(let e of qt){let t=e.Ge/e.ut;if(t>.5&&w(t*64)>.5)continue;let n=e.e/60,o=cs(t)*60*60|0,r=(e.t-e.s-o)/60;fe(K[0],e.pt,8,n,r)}};var jo=8,Bs=()=>{jo=8},qe=(e,t=7)=>{bn(K[0],e,t,2,jo,t,1),jo+=t+1},ro="",Ft="!",Zo=1,Tt=Me,fc=()=>{Tt=Me;for(let[,e]of at)if(e.q||e.Re){Tt=e;break}},Os=e=>{fc(),Zo=e,ro="",re(1e3)},Ns=()=>{Tt.q?Ft||(Ft="!"):Ft=""};var dc=(e,t,n,o)=>{let r=Tt.e/Zo,s=Tt.t/Zo;return r<e||s<t||r>=e+n||s>=t+o?0:1},G=(e,t,n,o,r)=>{let s=r?.w??64,i=r?.h??16,l=r?.visible??!0;if(dc(n,o,s,i)&&(ro=e,!Ft&&Tt.q&&(Ft=e)),l){let a=0,u=16777215;ro===e?Ft===e?a=1:a=0:u=11184810,H(C[1],n+2,o+2,0,s,i,1,0),H(C[1],n+a,o+a,0,s,i,1,u),fe(K[0],t,8,n+s/2+a,o+i/1.5+a)}return!Tt.q&&ro===e&&Ft===e?1:0};var jt=4,pc=1024/jt,so=$e(pc);Je(so);kn(so);var Is=()=>{Ur(so),kr(1,1,1,1),b.disable(2929),b.depthMask(!1),b.blendFunc(0,771)},zo=(e,t,n)=>{n/=jt,e/=jt,t/=jt,H(C[66],e,t,0,n,n)},ks=(...e)=>{let t=[2,0,1,1,0,0];for(let n of e)for(let o of n){let r=t[o.F];!o.F&&W&&o.c===W&&(r*=2),zo(o.e/60,(o.t-o.s)/60,r)}},Us=(e,t)=>H(so,0,0,0,jt,jt,.7,it(64+32*w(e),17,51),0,t&10027008);var Hs=!1,bc=0,Ws=0,xc={disconnected:"\u2B55",closed:"\u{1F534}",failed:"\u274C",connected:"\u{1F7E2}",completed:"\u2705",new:"\u{1F195}",checking:"\u{1F7E1}"},_c={connecting:"\u{1F7E1}",open:"\u{1F7E2}",closed:"\u{1F534}",closing:"\u274C"},ie=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],ce=[Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE],Vs=(e,t,n,o,r,s,i,l)=>{let a=e>Ws?"\u{1F310}":"\u{1F976}",u=(n-o)*60|0,m=ne(8,u);m&&(a+="\u{1F52E}"),a+=`~ ${m} of ${u}
`,Ws=e,_t&&(a+="debug-lag K: "+_t+`
`),a+="visible: "+r.length+`
`,a+="players: "+s.i[0].length+`
`,a+="barrels: "+s.i[1].length+`
`,a+="items: "+s.i[3].length+`
`,a+="bullets: "+s.i[2].length+`
`,a+="trees: "+i.length+`
`,a+=`\u250C ${Ee} | tic: ${e}, game-net: ${t-e}
`;for(let[,f]of he){let p=f.O,A=f.H,F=l.get(f.M);a+="\u251C "+f.I+f.M,a+=p?xc[p.iceConnectionState]??"\u2753":"\u{1F9FF}",a+=A?_c[A.readyState]:"\u{1F9FF}",F&&(a+=`+${F.l-(e-1)}`,a+="| x"+Xr(f).toString(16)),a+=`
`}for(let f of[].concat(...s.i))f.e<ie[0]&&(ie[0]=f.e),f.e>ce[0]&&(ce[0]=f.e),f.t<ie[1]&&(ie[1]=f.t),f.t>ce[1]&&(ce[1]=f.t),f.s<ie[2]&&(ie[2]=f.s),f.s>ce[2]&&(ce[2]=f.s),f.f<ie[0+3]&&(ie[0+3]=f.f),f.f>ce[0+3]&&(ce[0+3]=f.f),f.d<ie[1+3]&&(ie[1+3]=f.d),f.d>ce[1+3]&&(ce[1+3]=f.d),f.u<ie[2+3]&&(ie[2+3]=f.u),f.u>ce[2+3]&&(ce[2+3]=f.u);a+="x := ["+ie[0]+" .. "+ce[0]+`]
`,a+="y := ["+ie[1]+" .. "+ce[1]+`]
`,a+="z := ["+ie[2]+" .. "+ce[2]+`]
`,a+="u := ["+ie[3]+" .. "+ce[3]+`]
`,a+="v := ["+ie[4]+" .. "+ce[4]+`]
`,a+="w := ["+ie[5]+" .. "+ce[5]+`]
`,qe(a,4)},Xs=()=>{J.enabled&&(Be[48]&&(J.info=J.info?0:1),Be[49]&&++bc,Be[50]&&(J.collision=J.collision?0:1),Be[51]&&fr((_t+1)%3),Be[52]&&(Hs=!Hs))},hc=e=>{let t=$[e.F],n=t.radius,o=t.height,r=e.e/60,s=(e.t-e.s-o)/60,i=n/60/16;H(C[2],r,s,0,1,(e.s+o)/60),H(C[9],r,s,0,i,i,.5,16711680)},ys=e=>{re(0);for(let t of e)hc(t)};var Jo=16*60,Ac=Jo*2,Ys=61440/Ac,io=11,qs=5,gc=[0,1,Ys,Ys+1],co=(e,t)=>{var n;(e[n=(t.e>>io)+(t.t>>io<<qs)]??(e[n]=[])).push(t)},je=(e,t,n,o=1)=>{let r=e.e-Jo>>io,s=e.t-Jo>>io;r<0&&(r=0),s<0&&(s=0);let i=(s<<qs)+r;for(let l=0;l<4;++l){let a=t[i+gc[l]];if(a)for(let u of a)(u.ke|o)&1&&n(e,u)}};var Sc=e=>{let t=N.minimap;if(e.c){if(e.c===W)return t.colors.me}else return t.colors.npc;return t.colors.player},ao=(e,t,n,o,r)=>{if(n){let s=N.minimap,i=s.markerScale*r/me,l=s.size/61440;for(let a of n){let u=o;a.F===0&&(u=Sc(a)),H(C[0],e+l*a.e,t+l*a.t,M/4,i,i,1,u)}}},js=(e,t,n,o)=>{let r=N.minimap,s=r.size,i=r.colors,l=n-s-1,a=o+1;H(C[1],l,a,0,s,s,i.backgroundAlpha,i.background),ao(l,a,t,i.tree,$[4].radius),ao(l,a,e.i[1],i.barrel,$[1].radius),ao(l,a,e.i[3],i.item,$[3].radius),ao(l,a,e.i[0],i.player,$[0].radius)};var Dc=e=>e.o?!d[e.o].T||e.P||e._:!1,lo=(e,t,n)=>{let o=null,r=61440*61440;for(let s of t)if(n(s)){let i=is(e,s);i<r&&(o=s,r=i)}return o},zs=(e,t)=>{let n=!t.N&&t.m<5,o=!1;if(n){let r=e.i[3],s=lo(t,r,i=>i.n===0||i.n===1||i.n===4);if(s){let i=s.e-t.e,l=s.t-t.t,a=ve(i,l,32),u=ve(i,l,256);t.n=u<<13|a<<8|1|2}else o=!0}else if(t.o)if(Dc(t)){let r=e.i[0],s=lo(t,r,i=>i!==t);if(s){let i=s.e-t.e,l=s.t-t.t,a=0,u=0,m=0,f=0,p=d[t.o],A=de(i,l);A<p.st?(m=-i,f=-l,a=3):A>p.Ze?(m=i,f=l,a=3):u=8;let F=ve(m,f,32),U=ve(i,l,256);t.n=U<<13|F<<8|a|u}else o=!0}else{let r=e.i[3],s=lo(t,r,i=>i.n===5||i._>0);if(s){let i=s.e-t.e,l=s.t-t.t,a=ve(i,l,32),u=ve(i,l,256);t.n=u<<13|a<<8|1|2}else o=!0}else{let r=e.i[3],s=lo(t,r,i=>!!(i.n&8));if(s){let i=s.e-t.e,l=s.t-t.t,a=de(i,l),u=ve(i,l,32),m=ve(i,l,256),f=0;a<$[3].radius+$[0].radius&&!(t.v&2)&&(f=16),t.n=m<<13|u<<8|1|2|f}else o=!0}if(o){let r=L(32);t.n=r<<8|1,t.N||(!L(30)&&t.m<7&&(t.n|=4),t.m<10&&(t.n|=2))}n&&(t.n|=18)};var Pt=(e=1)=>new Float32Array([e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,e]),$s=(e,t,n,o,r,s,i)=>{e.set([2/(n-t),0,0,0,0,2/(r-o),0,0,0,0,1/(i-s),0,-(n+t)/(n-t),-(r+o)/(r-o),-s/(i-s),1])},Js=(e,t)=>{let n=Math.cos(t),o=Math.sin(t);e.set([1,0,0,0,0,n,o,0,0,-o,n,0,0,0,0,1])};var Qs=(e,t)=>{let n=Math.cos(t),o=Math.sin(t);e.set([n,o,0,0,-o,n,0,0,0,0,1,0,0,0,0,1])};var _n=(e,t,n)=>{let o=t[0],r=t[1],s=t[2],i=t[3],l=t[4],a=t[5],u=t[6],m=t[7],f=t[8],p=t[9],A=t[10],F=t[11],U=t[12],g=t[13],S=t[14],v=t[15],D=n[0],_=n[1],E=n[2],B=n[3];e[0]=D*o+_*l+E*f+B*U,e[1]=D*r+_*a+E*p+B*g,e[2]=D*s+_*u+E*A+B*S,e[3]=D*i+_*m+E*F+B*v,D=n[4],_=n[5],E=n[6],B=n[7],e[4]=D*o+_*l+E*f+B*U,e[5]=D*r+_*a+E*p+B*g,e[6]=D*s+_*u+E*A+B*S,e[7]=D*i+_*m+E*F+B*v,D=n[8],_=n[9],E=n[10],B=n[11],e[8]=D*o+_*l+E*f+B*U,e[9]=D*r+_*a+E*p+B*g,e[10]=D*s+_*u+E*A+B*S,e[11]=D*i+_*m+E*F+B*v,D=n[12],_=n[13],E=n[14],B=n[15],e[12]=D*o+_*l+E*f+B*U,e[13]=D*r+_*a+E*p+B*g,e[14]=D*s+_*u+E*A+B*S,e[15]=D*i+_*m+E*F+B*v};var ti=e=>{for(let t of e){let n=$[t.F],o=(2-t.s/(60*64))*n.shadowScale;H(C[6],t.e/60,t.t/60,0,o,o/4,.4,n.shadowColor,n.shadowAdd)}},ni=e=>{if(e&&(Re|0||we|0)){re(1e3);let t=Q;if(e.o){let o=d[e.o];if(o.T){if(e.p&&e._){let r=1-e.p/o.p,s=8;for(let i=0;i<s;++i){let l=Ae(r*s-i,0,1);H(C[3],Qe,Ke+1e3,i/s*M*2-M,2*l,5-2*l,1,16777113)}return}if(!e.P){if(w(t*32)>=0)for(let r=0;r<4;++r)H(C[3],Qe,Ke+1e3,t/10+r*M/2,2,4,1,16724787);return}}}let n=4+w(2*t)*V(4*t)/4+e.oe/8+e.C/10;for(let o=0;o<4;++o)H(C[3],Qe,Ke+1e3,t/10+o*M/2,2,n)}},ft=Pt(),Ks=Pt(),Gs=Pt(),ei=Pt(),Qo=Pt(),Zt=Pt(),oi=(e,t,n,o,r)=>{let s=b.drawingBufferWidth,i=b.drawingBufferHeight,l=Math.PI/4+o;$s(Ks,0,s,i,0,1e5,-1e5),Qo[12]=-e,Qo[13]=-t,Zt[0]=n,Zt[5]=n*V(l)*2,Zt[10]=n,Zt[12]=s/2,Zt[13]=i/2,Js(Gs,l),Qs(ei,r),_n(ft,ei,Qo),_n(ft,Gs,ft),_n(ft,Zt,ft),_n(ft,Ks,ft),Hr(ft)},An=e=>Bt(255*ne(1,2*e/fn)),hn=(e,t,n=0,o=1)=>Se(C[t],e.e/60,e.t/60,e.s/60+n,0,o,o,1,16777215,0,An(e.L)),ri=e=>hn(e,e.n+42),si=e=>hn(e,e.n+51),ii=e=>{if(e.p){let t=5*60;if(e.p<t){let o=8+16*(1-e.p/t);if(w(o*(t-e.p)/60)>=.5)return}}if(e.n&8)e._&&hn(e,45+5,8,.8),hn(e,10+e.o,4,.8);else{let t=Q*4+e.k/25;hn(e,45+e.n,Lt/60+V(t),.9+.1*w(4*t))}},ci=e=>{let t=e.e/60,n=e.t/60,o=e.s/60,r=Ce(e.d,e.f),s=e.n,i=mn[s],l=Ln(i.color),a=i.length,u=i.lightLength,m=i.size+i.pulse*w(32*Q+e.k)/2;re(o),H(C[i.images[0]],t,n,r,m*a,m,.1,16777215,1),H(C[i.images[1]],t,n,r,m*a/2,m/2,1,l),H(C[i.images[2]],t,n,r,2*u,2)},ai=e=>{if(e&&e.n&8){let t=d[e.o],n=t.I+" "+It[10+e.o];t.T&&(n+=e.P);let o=e.e/60,r=e.t/60;fe(K[0],n,7,o,r-28),fe(K[0],"Pick [E]",7,o,r-20)}};var tt=new Map,Ct=[],En=[],Ie=-1,ee=0,Ne=0,zt=!1,fo=!1,$t=!1,mo=0,Go=0,Rn=0,vt=[],gn=[],Sn=[],Dn=[],po=null,R=ln(),pi,k={title:!1,runAI:!1,playersAI:!1,hasPlayer:!1,tiltCamera:0,spawnNPC:!0,bloodRain:!1},Oe=0,bo=0,nt=e=>({M:R.ne++,F:e,e:0,t:0,s:0,f:0,d:0,u:0,n:0,c:0,C:0,oe:0,o:0,k:L(256),L:31,m:1,N:0,_:0}),Rc=()=>{let e=nt(3);return e.n=L(6),e.p=N.items.lifetime,dt(e),e},bi=e=>xt(tt,e,()=>({M:e,l:0,pe:0})),wc=e=>xt(R.Y,e,()=>({be:0,xe:0})),wn=()=>{Ss(),tt.clear(),Ct.length=0,En.length=0,R=ln(),rr(),Ie=-1,zt=!1,fo=!1,$t=!1,Qr(),mo=0,Go=0,Rn=0,k.title=!1,k.runAI=!0,k.playersAI=!1,k.hasPlayer=!0,k.tiltCamera=0,k.spawnNPC=!0,k.bloodRain=!1},er=()=>{De[0]=R.ie;let e=qr();vt.length=0,Dn.length=0;let t=R.ne;for(let n=0;n<N.trees.initCount;++n){let o=nt(4);o.n=e.treeGfx[L(e.treeGfx.length)],o.m=0,dn(o),vt.push(o),co(Dn,o)}De[0]=R.X,R.ne=t},dt=e=>{R.i[e.F].push(e)};function Fc(){let e=N.barrels.initCount,t=N.barrels.hp,n=N.barrels.dropWeapon.chance,o=N.barrels.dropWeapon.min;for(let r=0;r<e;++r){let s=nt(1);s.m=t[0]+L(t[1]-t[0]),s.n=L(2),L(100)<n&&(s.o=o+L(d.length-o)),dn(s),dt(s)}}var Tc=()=>{Ie=0,ee=0,R.ie=R.X=De[0],er(),Fc()},tr=()=>{R.X=R.ie=De[0],er();for(let e=0;e<13;++e){let t=e/13,n=nt(0);n.c=1+e,n.m=10,n._=10,n.N=10,xo(n,1+e%(d.length-1)),n.k=e+L(10)*14,n.n=No(t,256)<<13;let o=80+20*xe(Le());n.e=(1024/2+o*V(t*j))*60,n.t=(1024/2+o*w(t*j)+10)*60,dt(n)}I[0]=I[1]=1024/2,Ie=0,k.hasPlayer=!1,k.tiltCamera=.05,k.bloodRain=!0,k.title=!0},xi=e=>{Xn(e),W&&Ie<0&&!he.size&&Tc();let t=!1;Ie>=0&&(hi(Q),vs(),t=yc()),document.hidden||(qc(),jc()),Ie>=0&&(Cc(),vc(),t&&Yc(),Ai(),Si())},li=(e,t,n=0)=>{if(e){let o=d[e],r=It[10+e];return o.T?n?r+=(100*(o.p-n)/o.p|0)+"%":r+=t:r+="\u221E",r}return""},Pc=()=>{if(W){if(zt){let n=Jt();if(n){let o="",r=n.m;for(let i=0;i<10;){let l=r>i++,a=r>i++;o+=a?"\u2764\uFE0F":l?"\u{1F494}":"\u{1F5A4}"}let s=n.N;for(let i=0;i<10;){let l=s>i++,a=s>i++;o+=a?"\u{1F6E1}":l?"\u{1FA96}\uFE0F\uFE0F":""}qe(o);{let i=li(n.o,n.P,n.p);n.B&&(i+=" | "+li(n.B,n.Se)),qe(i)}qe(`\u{1F9F1}${n._}`)}else qe("tap to respawn")}else qe("joining");let e=n=>{let o=nr(n);return o?It[20+o.k%14]:"\u{1F441}\uFE0F"},t=n=>{let o=R.Y.get(n);return`|\u2620${o?.be??0}|\u{1FA99}${o?.xe??0}`};qe(e(W)+Ee+t(W));for(let[n,o]of he)qe((Dt(o)?e(n):"\u{1F534}")+o.I+t(n))}},Jt=()=>W?nr(W):void 0,nr=e=>R.i[0].find(t=>t.c==e),mi=(e,t)=>((t=Ct.find(n=>n.l==e))||(t={l:e,c:W},Ct.push(t)),t),_i=e=>e+Ze(8,(Q-Ne)*60|0),Cc=()=>{Xs();let e=Jt();e&&ts(e);let t=_i(ee),n=0;e&&((Ht||Wt)&&(n|=ve(Ht,Wt,32)<<8|1,Zn&&(n|=2)),(Re||we)&&(n|=ve(Re,we,256)<<13,qn&&(n|=8)),jn&&(n|=4),zn&&(n|=16),$n&&(n|=32),Jn&&(n|=64)),!k.title&&W&&!$t&&!e&&zt&&(Vn()||fo)&&(n|=128,$t=!0,fo=!1),Go!==n&&(t<=mo&&(t=mo+1),mo=t,mi(t).n&128&&(n|=128),mi(t).n=n,Go=n)},vc=()=>{if(!zt&&Ie>=0){for(let[e,t]of he)if(Dt(t)){let n=tt.get(e);if(!n||!n.Ie)return}else return;zt=!0,$t=!1,fo=!0}},or=(e=ee+(Q-Ne)*60|0)=>{for(let[,t]of tt)e>t.l&&(e=t.l);return e},Mc=e=>{for(let[,t]of tt)e>t.pe&&(e=t.pe);return e},hi=e=>{if(Ie<0)return 0;let t=or(),n=(e-Ne)*60|0,o=0;for(;ee<=t&&n--;)Ei(),rr(),++o,Ne+=1/60;let r=ht(Ne,e-8/60,.01);ee>t?e-Ne>8/60&&(Ne=r):ee+8<t&&(Ne-=1/60);let s=ee-1;En=En.filter(l=>l.l>s);let i=Mc(s);return Ct=Ct.filter(l=>l.l>i),o},Bc=new Int32Array(1024*16),Ai=()=>{let e=ee-1;for(let[t,n]of he)if(Dt(n)){let o=bi(t),r=_i(e);if(r>o.pe){let s={Xe:o.ft,Ce:o.l,l:r,ye:Ct.filter(i=>i.l>o.pe&&i.l<=r)};!o.Ie&&zt&&(s.K=R,o.l=R.l,o.pe=R.l),Vr(n,Zr(s,Bc))}}},Oc=(e,t)=>{if(Ie<0&&t.K&&t.K.l>or(1<<31)&&(Xn(performance.now()/1e3),Ne=Q,R=t.K,ee=Ie=R.l+1,er(),rr()),e.Ie=t.Xe,t.l>e.l){e.ft=!0;for(let n of t.ye)n.l>e.l&&En.push(n);e.l=t.l}e.pe<t.Ce&&(e.pe=t.Ce)},gi=(e,t)=>{Oc(bi(e),jr(e,new Int32Array(t))),document.hidden&&(Xn(performance.now()/1e3),hi(Q)&&(Ai(),Si()))},ui=0,Si=()=>{for(let[e]of tt)he.has(e)||tt.delete(e);if(W&&Ie>=0){for(let[e,t]of he)if(tt.get(e)?.Ie&&!Dt(t)){++ui>60*5&&(pt(),alert("connection lost"));return}}ui=0},xo=(e,t)=>{e.o=t;let n=d[t];n&&(e.p=0,e.P=n.T)},Di=e=>{let t=Ut(e.n>>13,256),n=V(t),o=w(t),r=nt(3);dt(r),Ge(r,e),Xt(r,n,o,0,me),et(r,e),yt(r,n,o,0,64),r.n=8,r.o=e.o,r.P=e.P,r._=0,r.p=N.items.lifetime,r.L=os,e.o=0,e.P=0},Nc=e=>{e.n&16?e.v&2||(e.v|=2,e.o&&(Di(e),e.B&&ho(e))):e.v&=-3},Ic=(e,t)=>{t.n&16&&(t.v&2||(t.v|=2,t.B?Di(t):ho(t),xo(t,e.o),t._=ne(10,t._+e._),t.P=e.P,Te(t,0),e.m=e.n=0))},_o=e=>W&&e.c===W&&e.F===0,kc=(e,t)=>{if(yo(e,t)){let n=_o(t);if(e.n&8){if(n&&!po&&(po=e),e._&&t._<10){let o=10-t._,r=Ae(0,e._,o);e._-=r,t._=ne(10,t._+r),Te(t,0),n&&ut(e,`+${r} mags`)}Ic(e,t)}else if(e.n===0||e.n===1){if(t.m<10){let o=e.n===1?2:1;t.m=ne(10,t.m+o),e.m=e.n=0,Te(t,0),n&&ut(e,`+${o} hp`)}}else if(e.n===2||e.n===3){if(t.c){let o=wc(t.c),r=e.n===3?5:1;o.xe+=r,e.m=e.n=0,Te(t,0),n&&ut(e,`+${r} cr`)}}else e.n===5?t._<10&&(t._=ne(10,t._+1),e.m=e.n=0,Te(t,0),n&&ut(e,`+${1} mags`)):e.n===4&&t.N<10&&(++t.N,e.m=e.n=0,Te(t,0),n&&ut(e,`+${1} cr`))}},Uc=()=>{let e=()=>{let r=R.i[0].filter(s=>s.c);return r.length?r[(Q/5|0)%r.length]:void 0},t=N.camera.baseScale,n=I[0],o=I[1];if(W&&!k.title){let r=Jt()??e();if(r?.c){let s=d[r.o],i=100*s.z*bo/(de(Re,we)+.001),l=r.e/60,a=r.t/60;n=l+s.se*(Qe-l)-i*Re,o=a+s.se*(Ke-a)-i*we,t*=s.Ye}}I[0]=ht(I[0],n,.1),I[1]=ht(I[1],o,.1),I[2]=Ar(I[2],t/Xe(),.05)},rr=()=>{for(let e of R.i)e.sort((t,n)=>t.M-n.M),Yo(e)},Ko=(e,t)=>{e.m&&e.o&&(e.c>0?e.c-t.c:-e.c-t.M)&&yo(e,t)&&uo(t,e)},Ei=()=>{(t=>{t=Ct.concat(En).filter(n=>n.l==t),t.sort((n,o)=>n.c-o.c);for(let n of t)if(n.n!==void 0){let o=nr(n.c);if(o)o.n=n.n;else if(n.n&128){let r=nt(0);r.c=n.c,dn(r),W==n.c&&(I[0]=r.e/60,I[1]=r.t/60),r.m=N.player.hp,r.N=N.player.sp,r._=N.player.mags,r.n=n.n,xo(r,1+L(3)),dt(r)}}})(ee),Uc(),gn.length=0,Sn.length=0;for(let t of R.i[0])Lc(t),co(gn,t),t.ke=1;for(let t of R.i[1])Kn(t),co(Sn,t),t.ke=1;po=null;for(let t of R.i[3])Kn(t),t.L||je(t,gn,kc),t.m&&t.p&&(--t.p,t.p||(t.m=0));for(let t of R.i[0])Nc(t);for(let t of R.i[2])t.n!=4&&(pn(t,0,0),t.m&&Wo(t)&&(--t.m,oo(8,t,t,mn[t.n].color)),je(t,gn,Ko),je(t,Sn,Ko),je(t,Dn,Ko)),t.C&&!--t.C&&(t.m=0);R.i=R.i.map(t=>t.filter(n=>n.m>0));for(let t of R.i[0])t.ke=0,je(t,Dn,Yt),je(t,Sn,Yt),je(t,gn,Yt,0);for(let t of R.i[1])t.ke=0,je(t,Dn,Yt),je(t,Sn,Yt,0);$t&&Jt()&&($t=!1);for(let t of vt)Ho(t);if(bs(),Oe=Mn(Oe),bo=Mn(bo),k.spawnNPC){let t=(1<<N.npc.period)-1;if((ee&t)===0){let n=0;for(let o of R.i[0])o.c||++n;if(n<N.npc.max){let o=nt(0);dn(o),o.m=10,o._=1,xo(o,L(N.npc.initWeaponLen)),dt(o),++n}}}k.bloodRain&&Vc({e:ae(61440),t:ae(61440),s:ae(128)*60,F:0},128,1),Rn<ee&&(Rn=ee),R.X=De[0],R.l=ee++},Hc=(e,t,n)=>{for(let o of R.i[0])o.c-e.c&&Gn(e,o,t,n)&&uo(o,e);for(let o of R.i[1])Gn(e,o,t,n)&&uo(o,e);for(let o of vt)Gn(e,o,t,n)&&uo(o,e)},Wc=e=>{Te(e,3);let t=1+L(3);for(let n=0;n<t;++n){let o=Rc();Ge(o,e),et(o,e);let r=16+48*xe(Le());if(mt(o,Le(j),r,r),ss(o,64),o.L=fn,e.o){o.n=8,o.o=e.o;let s=d[e.o];o.P=s.T,o._=s.T?1:0,o.p=N.items.lifetime,e.o=0}else if(e.B){o.n=8,o.o=e.B;let s=d[e.B];o.P=s.T,o._=s.T?1:0,o.p=N.items.lifetime,e.B=0}}if(e.F==0){let n=nt(1);Ge(n,e),et(n,e),n.u+=32,n.m=15,n.N=4,n.n=2,dt(n),to(256,e,128,n),Ts(32,e,n)}},uo=(e,t)=>{let n=!1;if(et(e,t,.1),e.L=fn,oo(8,t,t,mn[t.n].color),Te(e,7),e.m){let o=t.o;if(e.N>0){let r=Ae(o,0,e.N);r>0&&(e.N-=r,o-=r,e.F===0&&(oo(16,e,t,[10066329,52428,16776960]),Te(e,2)),n=!0)}if(o){let r=Ae(o,0,e.m);r>0&&(e.m-=r,o-=r,e.F===0&&(to(16,e,64,t),Te(e,2)),n=!0)}if(!e.m&&(Wc(e),e.F===0)){let r=R.Y.get(e.c);r&&(r.be=0);let s=t.c;if(s>0&&!e.F){let i=R.Y.get(s)??{xe:0,be:0};if(i.xe+=e.c>0?5:1,++i.be,R.Y.set(s,i),T.speech&&ee>Rn){let l=yn(s),a=yn(e.c);if(l){let u=Ln(a?N.voice.killAB:N.voice.killNPC);u=u.replace("{0}",l),u=u.replace("{1}",a),Gt(u)}}}}}if(t.m&&t.n!=4){if(n)t.m=0;else if(--t.m,t.m){let o=t.e-e.e,r=t.t-e.t,s=xe(o*o+r*r);if(s>0){o/=s,r/=s,Vt(t,o,r,1);let i=$[e.F].radius+Lt+1;t.e=e.e+i*o,t.t=e.t+i*r}}}},ho=e=>{let t=e.o,n=e.P;e.o=e.B,e.P=e.Se,e.B=t,e.Se=n},fi=e=>{if(e.o&&!e.p){let t=d[e.o];t.T&&!e.P&&(e._?e.p=t.p:(e.B&&(e.Se||!d[e.B].T)&&ho(e),_o(e)&&!(e.v&1)&&ut(e,"EMPTY!"),e.C=t.j))}};function di(e,t){let n=e.o?d[e.o].moveWeightK:1;return t*n|0}var Lc=e=>{k.runAI&&(!e.c||k.playersAI)&&zs(R,e);let t=e.s==0&&e.u==0;e.n&4&&t&&(e.s=1,e.u=di(e,N.player.jumpVel),t=!1,Te(e,5),no(e,240,8));let n=(t?16:8)/60,o=Ut(e.n>>8,32),r=Ut(e.n>>13,256),s=V(o),i=w(o),l=V(r),a=w(r);if(e.n&1){let m=di(e,e.n&2?N.player.runVel:N.player.walkVel);if(e.f=ct(e.f,m*s,m*n),e.d=ct(e.d,m*i,m*n),t){let p=256/m|0;if(!((ee+e.k)%p)){Te(e,4),Nt(4)||no(e,240,1);let F=(ee+e.k)%(2*p);Cs(e,F?120:-120)}}}else Vo(e,32*n);if(e.n&64?e.v&8||(e.v|=8,e.B&&ho(e)):e.v&=-9,e.o){let m=d[e.o];if(e.n&32?(ko(e)&&(e._?e.p=m.p:_o(e)&&!(e.v&4)&&ut(e,"NO MAGS!")),e.v|=4):e.v&=-5,m.T&&e.p&&e._&&(--e.p,e.p||(--e._,e.P=m.T)),e.n&8){if(e.C=Mn(e.C),!e.C){if(fi(e),!m.T||!e.p&&e.P){m.T&&(--e.P,e.P||fi(e)),_o(e)&&(Oe=Ze(m.rt,Oe),bo=5),e.C=m.j,e.oe=ct(e.oe,m.Z,1),e.s<=0&&yt(e,l,a,-1,-m.we),Te(e,1);for(let p=0;p<m.tt;++p){let A=r+m.nt*(Le()-.5)+m.ce*(e.oe/m.Z)*(Le()-.5),F=V(A),U=w(A),g=m.G+m.ot*(Le()-.5),S=nt(2);S.c=e.c||-e.M,Ge(S,e),Xt(S,F,U,0,60*m.Me),S.s+=Uo-12*60,yt(S,F,U,0,g),S.o=m.$,S.n=m.le,S.m=m.Be,S.C=m.je,dt(S),m.le==4&&(Hc(S,F,U),S.o=0)}m.le&&Ps(e,Uo,m.Fe)}e.v|=1}}else e.v&=-2,e.oe=e.oe/3|0,e.C=ct(e.C,m.re,m.et)}let u=e.u;if(Kn(e),!t&&e.s<=0&&u<=0){let p=en(8*u/N.player.jumpVel)|0;p>0&&no(e,240,p)}},Vc=(e,t,n,o)=>{to(n,e,t,o)},Xc=(e=R)=>({...e,i:e.i.map(t=>t.map(n=>({...n}))),Y:new Map(e.Y.entries())}),yc=()=>{if(!1)return!1;let e=ne(8,(Q-Ne)*60|0);if(!e)return!1;for(gs(),pi=R,R=Xc();e--;)Ei();return!0},Yc=()=>{R=pi,De[0]=R.X,ee=R.l+1,Ds()},qc=()=>{Zc(vt,...R.i),ot.sort((e,t)=>61440*(e.t-t.t)+e.e-t.e),Is(),ks(R.i[0],R.i[2],R.i[3]),k.title&&zo(I[0],I[1],3+St(1)),ge(),gt(I[0]+(Ve(Oe/5)|0),I[1]+(Ve(Oe/5)|0),.5,.5,Ve(Oe/(8*50)),1/I[2]);{let e=I[0]+(Ve(Oe/5)|0),t=I[1]+(Ve(Oe/5)|0),n=1/I[2],o=Ve(Oe/(8*50)),r=Ve(Oe/(8*50));o+=k.tiltCamera*Math.sin(Q),r+=k.tiltCamera*Math.cos(Q),oi(e,t,n,o,r)}if(b.clear(256),b.enable(2929),b.depthFunc(513),b.depthMask(!0),ni(Jt()),Es(),Kc(),re(0),H(kt,0,0),re(-1),H(C[1],-1e3,-1e3,0,1024+2e3,1024+2e3,1,2232576),ge(),b.enable(2929),b.depthFunc(515),b.depthMask(!1),Gc(),Cn("collision")&&ys(ot),k.title)for(let e=10;e>0;--e){let t=.5*w(e/4+Q*16),n=it(32*(11-e)+32*t&255,0,0),o=1+e/100,r=t*e/100,s=e/4,i=I[1]+s;Se(C[65],I[0]+Ve(s),i+40+Ve(s),40,r,o,o,1,n)}ge(),b.disable(2929),re(0),Us(Q,An(Jt()?.L)),Ms(),ai(po),ge()},jc=()=>{re(1e3);let e=Xe();gt(0,0,0,0,0,e),W&&js(R,vt,b.drawingBufferWidth/e,0),k.title||(Pc(),ns()),Cn("info")&&Vs(ee,or(),Q,Ne,ot,R,vt,tt),Cn("fps")&&bn(K[0],`FPS: ${ze.fps} | DC: ${ze.drawCalls}`,4,2,5,0,0),ge()},ot=[],Zc=(...e)=>{ot.length=0;let t=me*2,n=b.drawingBufferWidth,o=b.drawingBufferHeight,r=I[2]/2,s=-r*n+I[0]-t,i=-r*o+I[1]-t-128,l=r*n+I[0]+t,a=r*o+I[1]+t+128;for(let u of e)for(let m of u){let f=m.e/60,p=m.t/60;(f>s&&f<l&&p>i&&p<a||m.F==2&&m.n==4)&&ot.push(m)}};function zc(e){let t=An(e.L),n=e.k+Q,o=N.bodyColor[e.k%N.bodyColor.length],r=o,s=o,i=e.e/60,l=e.t/60,a=e.s/60,u=de(e.f,e.d,e.u),m=e.n&2?1:.8,f=ne(1,u/100),p=-.5*f*.5*(1+w(40*m*n)),A=(1-f)*((1+w(10*n)**2)/4);p=p+A;let F=5-4*f*.5*(1+w(40*m*n)),U=5-4*f*.5*(1+w(40*m*n+M)),g=d[e.o],S=Ut(e.n>>13,256),v=i,D=l,_=a+un,E=Ce(l+1e3*w(S)-D+_,i+1e3*V(S)-v),B=0;E<-.2&&E>-M+.2&&(B=1);let Z=w(E-M),Y=6+12*(B?Z*Z:0),X=1;if((E<-M*.5||E>M*.5)&&(X=-1),g.ae){let st=ne(1,g.re>0?e.C/g.re:Ze(0,(e.C/g.j-.5)*2));Y+=w(st*M)*g.ae,E-=-X*M*.25*w((1-(1-st)**2)*j)}v+=Y*V(E),D+=Y*w(E),Se(C[2],i-3,l,a+5,0,2,F,1,r,0,t),Se(C[2],i+3,l,a+5,0,2,U,1,r,0,t),Se(C[0],i,l,a+7-p,0,8,6,1,s,0,t);let te=i+4,O=i-4,q=l-a-un+p*2,Pe=D-_,Eo=Ce(-q+Pe,v-te),Ue=Ce(-q+Pe,v-O),Kt=de(v-O,Pe-q)-1,rt=de(v-te,Pe-q)-1;if(e.o)Se(C[4],i+4,l+.2,a+10-p,Eo,rt,2,1,r,0,t),Se(C[4],i-4,l+.2,a+10-p,Ue,Kt,2,1,r,0,t);else{let st=f*w(20*m*n),mr=f*V(20*m*n),Ro=5;!e.c&&e.m<10&&!e.N&&(st-=M/2,mr+=M/2,Ro+=4),Se(C[4],i+4,l+.2,a+10-p,st+M/4,Ro,2,1,r,0,t),Se(C[4],i-4,l+.2,a+10-p,mr+M-M/4,Ro,2,1,r,0,t)}}var $c=e=>{let t=An(e.L),n=e.k+Q,o=e.c?20+e.k%14:34+e.k%8,r=e.e/60,s=e.t/60,i=e.s/60,l=de(e.f,e.d,e.u),a=e.n&2?1:.8,u=ne(1,l/100),m=-.5*u*.5*(1+w(40*a*n)),f=(1-u)*((1+w(10*n)**2)/4);m=m+f;let p=d[e.o],A=Ut(e.n>>13,256),F=p.qe*vn,U=p.dt,g=1,S=r,v=s,D=i+un,_=Ce(s+1e3*w(A)-v+D,r+1e3*V(A)-S),E=U,B=g,Z=0;_<-.2&&_>-M+.2&&(Z=1);let Y=w(_-M),X=6+12*(Z?Y*Y:0),te=1;if((_<-M*.5||_>M*.5)&&(te=-1),p.ae){let O=ne(1,p.re>0?e.C/p.re:Ze(0,(e.C/p.j-.5)*2));X+=w(O*M)*p.ae,_-=-te*M*.25*w((1-(1-O)**2)*j)}S+=X*V(_),v+=X*w(_),te<0&&(E*=te,_-=M+2*F),_+=F,Z&&e.o&&Se(C[10+e.o],S,v-1,D,_,E,B);{let O=e.u/500,q=e.f/500;Se(C[o],r,s+.1,i+16-m*2,q,1-O,1+O,1,16777215,0,t)}if(!Z&&e.o&&Se(C[10+e.o],S,v+1,D,_,E,B),e.c>0&&e.c!==W){let O=yn(e.c);O&&(re(0),fe(K[0],O,6,r,s-28))}},Jc=[$c,ri,ci,ii,si],Qc=[zc];function Kc(){for(let e=ot.length-1;e>=0;--e){let t=ot[e];Qc[t.F]?.(t)}}var Gc=()=>{qo(),re(.1),ti(ot),Rs();for(let e of ot)Jc[e.F](e);ws()},Te=(e,t)=>{if(ee>Rn){let n=N.camera.listenerRadius,o=(e.e/60-I[0])/n,r=(e.t/60-I[1])/n,s=1-de(o,r);s>0&&pr(Qn[t],s,Ae(o,-1,1))}};var Ri=(e,t)=>{gi(e,t.data)};var wi=[{urls:"stun:openrelay.metered.ca:80"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}];var ir=e=>e,ke=0,he=new Map,Qt=null,W=0,Ee=T.name,Mt=[],Ao=!1,Fi=1,So=[],Ti=()=>fetch(ir("i"),{method:"POST"}).then(e=>e.json()).then(e=>Number.parseInt(e?.on)).catch(()=>0),cr=e=>{e||(e="Guest "+(Math.random()*1e3|0)),Ee=He("name",e.trim().substring(0,32).trim())},Fn=(e,t,n,o=0)=>Mt.push([W,e,t,o,n]),ea=(e,t,n,o)=>{So[Fi]=o,Fn(e,t,n,Fi++)},pt=()=>{Qt&&(Qt.close(),Qt=null),he.forEach(Pi),W=0,ke=0},ta=(e,t)=>e.O.setRemoteDescription(t).then(()=>e.O.createAnswer()).then(n=>e.O.setLocalDescription(n)).then(()=>e.O.localDescription.toJSON()).catch(()=>{}),na=[,e=>ta(go(e[0]),e[4]),(e,t)=>{e[4].candidate&&go(e[0]).O.addIceCandidate(new RTCIceCandidate(e[4])).catch(n=>{})},e=>{go(e[0]).I=e[4]}],oa=e=>na[e[2]](e)?.then(t=>Mt.push([W,e[0],e[2],e[3],t])),ar=()=>{ke>1&&!Ao&&Mt.length&&(Ao=!0,ra(Mt).then(e=>{Mt=Mt.slice(e),Ao=!1}).catch(pt))},ra=e=>fetch(ir("_"),{method:"POST",body:JSON.stringify([W,e])}).then(t=>t.json()),sa=[pt,()=>{Fn(0,0,0),ar()},(e,t)=>{t=e.split(",").map(Number),W=t.shift(),ke=2,Promise.all(t.map(n=>(Fn(n,3,Ee),ca(go(n))))).then(n=>ke=3).catch(pt)},(e,t,n,o)=>{t=JSON.parse(e),n=t[3],o=So[n],So[n]=0,(o||oa)(t)},(e,t)=>{t=+e,t>0?Fn(t,3,Ee):Pi(he.get(-t))}],lr=e=>{ke||(e?(ke=3,W=1):(ke=1,Ao=!1,Mt=[],So=[],Qt=new EventSource(ir("_?v="+Pn)),Qt.onerror=t=>{pt()},Qt.onmessage=t=>sa[t.data[0]]?.(t.data.substring(1))))},sr=(e,t)=>e.O.createOffer({iceRestart:t}).then(n=>e.O.setLocalDescription(n)).then(()=>ea(e.M,1,e.O.localDescription.toJSON(),n=>e.O.setRemoteDescription(new RTCSessionDescription(n[4])))),ia=(e,t)=>{let n={M:e,O:t=new RTCPeerConnection({iceServers:wi})};return t.onicecandidate=o=>{o.candidate&&Fn(e,2,o.candidate.toJSON())},t.onnegotiationneeded=()=>{sr(n,!1)},t.ondatachannel=o=>{n.H=o.channel,Ci(n)},n},Pi=e=>{he.delete(e?.M)&&(e.H?.close(),e.O?.close())},ca=e=>(e.O.oniceconnectionstatechange=t=>{"fd".indexOf(e.O?.iceConnectionState[0])>=0&&sr(e,!0).catch()},sr(e).then(t=>(e.H=e.O.createDataChannel(0,{ordered:!1,maxRetransmits:0}),Ci(e),new Promise((n,o)=>{let r=20,s=setInterval(()=>{Dt(e)?(clearInterval(s),n()):--r||o()},200)})))),Ci=e=>{e.H&&(e.H.binaryType="arraybuffer",e.H.onmessage=t=>Ri(e.M,t))},go=e=>xt(he,e,ia),Dt=e=>e?.H?.readyState[0]=="o"&&e?.O?.iceConnectionState[1]=="o";var bt=[0,2,3,5,7,8,10,12,12+2,12+3,12+5,12+7,12+8,12+10],Do=be.createBiquadFilter();Do.connect(be.destination);var Tn=(e,t,n,o=1,r=be.destination)=>{let s=be.createBufferSource();s.buffer=Qn[e],s.detune.value=t*100,s.connect(r),s.start(n,0,o)},Mi=0,vi=0;function aa(e,t,n){let o=0,r=0,s=ae(2)&&!e,i=ae(2)&&!e,l=ae(4)==0||e,a=e?0:ae(2),u=e?ae(2e3):ae(1e4);Do.Q.linearRampToValueAtTime(a,t+(o+8)*n),Do.frequency.linearRampToValueAtTime(u,t+(o+8)*n);for(let m=0;m<16;++m){Mi%4==3&&(ae(4)==0&&!e?r=14+ae(5):r=4+ae(5));let f=bt[r%bt.length];o%4==2&&(f=bt[(r+1)%bt.length]),o%4==3&&(f=bt[(r+2)%bt.length]),m>12&&(f=bt[(r+1+ae(5))%bt.length]),(o%16<8||!l)&&Tn(8,f,t+n*o,n,Do),o%4==0&&(o%8==4&&s?Tn(10,-4,t+o*n,n*2):Tn(9,0,t+o*n,n*2)),o%16==11&&ae(2)&&s&&Tn(9,0,t+o*n,n*2),(o%8>5||o%2==0)&&i&&Tn(11,0,t+o*n,n),++o}}var Bi=e=>{let t=be.currentTime;if(t>=vi){let n=60/(110+15*w(t/10))/4;vi=t+16*n,T.music&&aa(e,t,n),++Mi}};function Oi(e){let t=performance.now(),n=o=>{if(requestAnimationFrame(n),T.frameRateCap>0){let r=o-t,s=.1,i=1e3/T.frameRateCap;r>=i-s&&(t=o-r%i,e(o))}else t=o,e(o)};requestAnimationFrame(n)}{let e=0,t=0,n=0,o=0,r=()=>{t=2,wn(),tr(),k.title=!0,k.playersAI=!0,k.spawnNPC=!0,Gt("13 the game")};Ee||cr(),Promise.all([new FontFace("m","url(m.ttf)").load().then(i=>document.fonts.add(i)),new FontFace("e","url(e.ttf)").load().then(i=>document.fonts.add(i))]).then(i=>{ms(),yr(),t=1,wn(),tr(),k.spawnNPC=!1});let s=[,i=>{let l=Xe(),a=b.drawingBufferWidth/l|0,u=b.drawingBufferHeight/l|0,m=a>>1,f=u>>1;gt(0,0,0,0,0,l);let p=14+.5*Math.sin(8*i);w(i*8)<=0&&fe(K[0],"PRESS ANY KEY",p,m,f+50,14286694),ge(),Vn()&&(t=2,k.playersAI=!0,k.spawnNPC=!0,Ti().then(A=>{e=A}))},()=>{let i=Xe();gt(0,0,0,0,0,i),Os(i);{let l=b.drawingBufferWidth/i|0,a=b.drawingBufferHeight/i|0,u=l>>1,m=a>>1;if(n===0)fe(K[0],"Welcome back,",7,u,14),G("change_name",Ee+" \u270F\uFE0F",u-64/2,20)&&cr(prompt("your name",Ee)),fe(K[0],e+" playing right now",7,u,m+45),G("dev_mode","",u-40,m-40,{w:80,h:80,visible:!1})&&++o>3&&(J.enabled=1,n=2),G("start","\u2694 FIGHT",u-50,m+50,{w:100,h:20})&&(t=3,wn(),k.title=!0,k.tiltCamera=.05,k.bloodRain=!0,lr()),G("practice","\u{1F3F9} PRACTICE",u-50,m+75,{w:100,h:20})&&(t=4,wn(),lr(!0)),G("settings","\u2699\uFE0F SETTINGS",u-50,m+108,{w:100,h:16})&&(n=1);else if(n===1){fe(K[0],"\u2699\uFE0F SETTINGS",20,u,30),G("sounds","\u{1F50A} SOUNDS: "+(T.sound?"ON":"OFF"),u-50,m-70,{w:100,h:20})&&He("sound",T.sound?0:1),G("music","\u{1F3B5} MUSIC: "+(T.music?"ON":"OFF"),u-50,m-40,{w:100,h:20})&&He("music",T.music?0:1),G("speech","\u{1F4AC} SPEECH: "+(T.speech?"ON":"OFF"),u-50,m-10,{w:100,h:20})&&He("speech",T.speech?0:1),G("blood",["\uFE0F\u200D\u{1FA79} FX: NONE","\u{1FA78} FX: BLOOD","\u{1F3A8} FX: PAINT "][T.blood],u-65,m+20,{w:80,h:20})&&He("blood",(T.blood+1)%3);let p=T.particles>0?"X"+T.particles:"OFF";G("particles","\uFE0F\u2728 "+p,u+25,m+20,{w:40,h:20})&&(T.particles*=2,T.particles<=0&&(T.particles=.5),T.particles>4&&(T.particles=0),He("particles",T.particles)),G("highDPI","\u{1F5A5}\uFE0F HIGH-DPI: "+(T.highDPI?"ON":"OFF"),u-85,m+50,{w:80,h:20})&&He("highDPI",T.highDPI?0:1),G("frameRateCap","FPS LIMIT: "+(T.frameRateCap>0?T.frameRateCap+"hz":"OFF"),u+5,m+50,{w:80,h:20})&&He("frameRateCap",T.frameRateCap>0?0:wo),G("back","\u2B05 BACK",u-50,m+90,{w:100,h:20})&&(n=0)}else n===2&&(fe(K[0],"\u2699\uFE0F DEVELOPER",20,u,30),G("fps","FPS: "+(J.fps?"ON":"OFF"),u-50,m-70,{w:100,h:20})&&(J.fps=J.fps?0:1),G("collision","COLLISION: "+(J.collision?"ON":"OFF"),u-50,m-40,{w:100,h:20})&&(J.collision=J.collision?0:1),G("console","LOGS: "+(J.console?"ON":"OFF"),u-50,m-10,{w:100,h:20})&&(J.console=J.console?0:1),G("info","INFO: "+(J.info?"ON":"OFF"),u-50,m+20,{w:100,h:20})&&(J.info=J.info?0:1),G("back","\u2B05 BACK",u-50,m+90,{w:100,h:20})&&(n=0));G("version_tag","\u{1F3F7} v"+Pn,2,a-16,{w:48,h:14,visible:!0})&&open("https://github.com/eliasku/13","_blank")}Ns(),ge()},i=>{let l=Xe(),a=b.drawingBufferWidth/l|0,u=b.drawingBufferHeight/l|0,m=a>>1,f=u>>1;gt(0,0,0,0,0,Xe());let p=10+.5*Math.sin(4*i);fe(K[0],"CONNECTING",p,m,f+40,14286694),fe(K[0],".".repeat(i*7&7),p,m,f+50,14540253),ge(),ke==3?(k.title=!1,k.tiltCamera=0,k.bloodRain=!1,t=4,Gt("fight")):ke||r()},()=>{Be[53]&&pt(),ke||r()}];Oi(i=>{i/=1e3,vr(i),Bi(t!=4),t>=1&&xi(i),s[t]?.(i),us(),Bs(),Jr(),ar(),Ir()})}